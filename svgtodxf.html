<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>randyp</title>
    <link crossorigin="anonymous" href="css/index.css" media="all" rel="stylesheet">
    <link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.1.0/octicons.min.css" media="all" rel="stylesheet">
    <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" >
    <link crossorigin="anonymous" href="https://assets-cdn.github.com/pinned-octocat.svg" rel="icon" sizes="any" mask="" >

    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script>
        $(document).ready(function(){
            var $svgIn = $("#svg-in");
            var $dxfOut = $("#dxf-out");
            var $version = $("#version");
            var $convert = $("#convert").css({
                opacity: 0
            });
            
            function update(){
                $.ajax({

                    url: "http://codegrump.com/svg-to-dxf",
                    data: $svgIn.text(),
                    type: 'POST',
                    crossDomain: true,
                    dataType: 'image/svg',
                    success: function(data) {
                        console.log("success", data);
                        $dxfOut.text(data);    
                    },
                    error: function(response) {
                        console.log("error", response);
                        $dxfOut.text(response.responseText);
                    },
                    complete: function(){
                        $convert.animate({
                            opacity: 1
                        }, 100, function(){
                            $convert.animate({
                                opacity: 0
                            }, 500)
                        });
                    }
                });
            }
            
            var timeout = null;
            $svgIn.on('input',function(e){
                console.log(timeout);
                clearTimeout(timeout);
                timeout = setTimeout(update, 500);
            });
            
            update();
        });
    </script>
    
    <style>
        h1, h2 {
            text-align: center;
        }
        textarea {
            width: 100%;
            resize: none; 
            height: 600px;
        }
    </style>
</head>
<body>
<h1 >Version <span id="version">0.0.2</span></h1>
<div style="overflow: hidden; width: 100%; height: 100%">
    <div style="float:left; width: 45%">
        <h2>SVG</h2>
        <textarea id="svg-in"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
            <svg id="svg2" xmlns="http://www.w3.org/2000/svg" version="1.2">
                <g stroke="#000" stroke-width="0.5" fill="#f00">
                    <!-- 0 0-->
                    <g transform="translate(50,50)">
                        <path d="M0,0 L50,30 H80 V0 Z"/>
                    </g>
                    <!-- 0 1 -->
                    <g transform="translate(200,100) scale(5)">
                        <path d="M 2.59765625,-10.56640625 L 2.59765625,-3.720703125 Q 2.59765625,-2.099609375 3.203125,-1.5234375 Q 3.8671875,-0.966796875 5.60546875,-0.966796875 Q 7.421875,-0.966796875 8.017578125,-1.5234375 Q 8.61328125,-2.080078125 8.61328125,-3.720703125 L 8.61328125,-10.56640625 L 9.921875,-10.56640625 L 9.921875,-3.359375 Q 9.921875,-1.4453125 8.9208984375,-0.5859375 Q 7.919921875,0.2734375 5.60546875,0.2734375 Q 3.3203125,0.2734375 2.32421875,-0.5859375 Q 1.298828125,-1.4453125 1.298828125,-3.359375 L 1.298828125,-10.56640625 L 2.59765625,-10.56640625 Z M 13.90625,-4.765625 L 18.525390625,-4.765625 Q 19.12109375,-4.765625 19.501953125,-5.0390625 Q 19.86328125,-5.361328125 19.86328125,-5.87890625 Q 19.86328125,-6.38671875 19.521484375,-6.6796875 Q 19.1796875,-6.982421875 18.583984375,-6.982421875 L 13.90625,-6.982421875 L 13.90625,-4.765625 M 13.90625,-3.583984375 L 13.90625,0 L 12.646484375,0 L 12.646484375,-8.173828125 L 18.525390625,-8.173828125 Q 19.74609375,-8.173828125 20.4541015625,-7.578125 Q 21.162109375,-6.982421875 21.162109375,-5.8984375 Q 21.162109375,-4.8828125 20.478515625,-4.23828125 Q 19.8046875,-3.583984375 18.662109375,-3.583984375 L 13.90625,-3.583984375 Z"/>
                    </g>
                    <!-- 0 2 -->
                    <g transform="translate(650,-50) scale(2)">
                        <path id="path8"
                              d="m-122.3,84.285s0.1,1.894-0.73,1.875c-0.82-0.019-17.27-48.094-37.8-45.851,0,0,17.78-7.353,38.53,43.976z"/>
                    </g>
                    <!-- 0 3 -->
                    <g transform="translate(510,60) scale(2)">
                        <circle r="20"/>
                    </g>
                    <!-- 0 4 -->
                    <g transform="translate(650,50) scale(2)">
                        <ellipse cx="20" cy="10" rx="40" ry="20"/>
                    </g>
                    <!-- 0 4 -->
                    <g transform="translate(850,50) rotate(45) scale(1.5,1)">
                        <circle cx="10" cy="10" r="20"/>
                    </g>
                    <!-- 1 0 -->
                    <g transform="translate(50,250)">
                        <rect x="0" y="0" width="50" height="100"/>
                    </g>
                    <!-- 1 1 -->
                    <g transform="translate(200,250)">
                        <line x1="0" y1="0" x2="50" y2="100"/>
                    </g>
                    <!-- 1 2 -->
                    <g transform="translate(325,250)">
                        <polygon points="60,20 100,40 100,80 60,100 20,80 20,40"/>
                    </g>
                    <!-- 1 3 -->
                    <g transform="translate(475,250)">
                        <polyline points="60,20 100,40 100,80 60,100"/>
                    </g>
                    <!-- 1 3 -->
                    <g transform="translate(675,270)">
                        <path d="M0,0 A37,37 0 0,1 50,50"/>
                    </g>
                    <!-- 2 0 -->
                    <g transform="translate(0,400)">
                        <defs>
                            <font id="Font1" horiz-adv-x="1000">
                                <font-face font-family="Super Sans" font-weight="bold" font-style="normal"
                                           units-per-em="1000" cap-height="600" x-height="400"
                                           ascent="700" descent="300"
                                           alphabetic="0" mathematical="350" ideographic="400" hanging="500">
                                    <font-face-src>
                                        <font-face-name name="Super Sans Bold"/>
                                    </font-face-src>
                                </font-face>

                                <missing-glyph>
                                    <path d="M0,0h200v200h-200z"/>
                                </missing-glyph>
                                <glyph unicode="!" horiz-adv-x="80" d="M0,0h200v200h-200z" />
                                <glyph unicode="@" d="M0,50l100,300l400,100z" />
                            </font>
                        </defs>
                        <text x="100" y="100"
                              style="font-family: 'Super Sans', Helvetica, sans-serif;
                  font-weight: bold; font-style: normal">!!!@@@!!!</text>
                    </g>
                </g>
            </svg></textarea>
    </div>
    <div style="float: left; height: 100%; width: 10%">
        <p id="convert" style="text-align: center; margin: 300px 0 0 0"><span class="mega-octicon octicon-diff-renamed"></span></p>
    </div>
    <div style="float:left; width: 45%">
        <h2 style="text-align: center">DXF</h2>
        <textarea id="dxf-out" readonly="true"></textarea>
    </div>
</div>
</body>
</html>   
